# Thread Manager for Amp

A local web UI for managing [Amp](https://ampcode.com) AI coding agent threads â€” monitor, interact with, and organize multiple concurrent agent sessions from your browser.

## Quick Start

### Prerequisites

- **Node.js** 25+ (needed to compile native modules like `better-sqlite3` and `node-pty`)
- **pnpm** 10+ â€” install with `npm install -g pnpm`
- **[Amp CLI](https://ampcode.com)** installed and authenticated (`amp` command available)

### Install & Run

```bash
pnpm install
pnpm dev
```

Open http://localhost:5173

## Why?

When working with multiple Amp threads simultaneously â€” across repos, features, and tasks â€” it's hard to keep track of what's running, what's blocked, and what each thread has done. This tool gives you a single dashboard to manage it all.

## Features

### ğŸ–¥ï¸ Multi-Terminal Management

- Run multiple Amp threads side-by-side with tabs, split views, and grid layouts
- Real-time streaming of agent output via WebSocket
- Rich message rendering with syntax highlighting for code and tool outputs
- Conversation minimap for navigating long threads
- Auto-reconnect on connection drops with output resumption

### ğŸ“‹ Thread Organization

- **Table view** â€” sortable, filterable thread listing with bulk operations
- **Card view** â€” detailed cards grouped by date
- **Kanban view** â€” drag threads between status columns (Active, Blocked, Paused, Done)
- Thread status tracking with blocker relationships between threads
- Labels and linked issue URLs for organization
- Handoff support to create continuation threads

### ğŸ” Discovery & Context

- **Thread chains** â€” visualize parent/child handoff relationships
- **Related threads** â€” find threads that touched the same files
- **Git activity** â€” see commits, branches, and PRs correlated to each thread
- **Source control** â€” view uncommitted changes per workspace with inline diffs
- **Content search** â€” full-text search across all thread messages

### ğŸ› ï¸ Built-in Tools

- **Shell terminal** â€” integrated xterm.js terminal sessions
- **Command palette** (`âŒ˜O`) â€” quick access to all actions
- **Skills management** â€” list, add, and remove Amp skills
- **MCP status** â€” view connected MCP servers
- **Image viewer** â€” view images attached to or generated by threads

### ğŸ¨ Customization

- **30+ theme presets** â€” Cyberpunk 2077, Dracula, Tokyo Night, Nord, Catppuccin, Gruvbox, and more
- Adaptive theme system that derives a full UI from just 3 colors (bg, fg, accent)
- Light and dark themes supported
- Configurable layouts and view preferences
- Notification sounds for completed tasks

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (React 19)                   â”‚
â”‚  src/                                                    â”‚
â”‚  â”œâ”€â”€ components/     # UI components                     â”‚
â”‚  â”‚   â”œâ”€â”€ terminal/   # WebSocket terminal + messages     â”‚
â”‚  â”‚   â”œâ”€â”€ ThreadList/ # Table view with bulk selection    â”‚
â”‚  â”‚   â”œâ”€â”€ sidebar/    # Workspace tree navigation         â”‚
â”‚  â”‚   â””â”€â”€ Toolbar/    # Search, filters, view switching   â”‚
â”‚  â”œâ”€â”€ hooks/          # Data fetching + state hooks       â”‚
â”‚  â”œâ”€â”€ commands/       # Command palette registry          â”‚
â”‚  â””â”€â”€ lib/            # Theme system, utilities           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Shared (shared/)                           â”‚
â”‚  types.ts, websocket.ts, validation.ts, cost.ts,         â”‚
â”‚  utils.ts, constants.ts                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    HTTP + WebSocket
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Backend (Node.js)                        â”‚
â”‚  server/                                                 â”‚
â”‚  â”œâ”€â”€ websocket.ts    # Per-thread session management     â”‚
â”‚  â”œâ”€â”€ shell-websocket.ts  # Shell terminal PTY sessions   â”‚
â”‚  â”œâ”€â”€ routes/         # REST API handlers                 â”‚
â”‚  â”‚   â”œâ”€â”€ threads.ts  # Thread CRUD + search + discovery  â”‚
â”‚  â”‚   â”œâ”€â”€ metadata.ts # Status, labels, blockers          â”‚
â”‚  â”‚   â”œâ”€â”€ git.ts      # Git status + diffs                â”‚
â”‚  â”‚   â”œâ”€â”€ skills.ts   # Amp skills + MCP management       â”‚
â”‚  â”‚   â””â”€â”€ artifacts.ts # Notes + image storage            â”‚
â”‚  â””â”€â”€ lib/            # Core logic                        â”‚
â”‚      â”œâ”€â”€ threadCrud.ts    # Thread CRUD operations        â”‚
â”‚      â”œâ”€â”€ threadSearch.ts  # Search + related threads      â”‚
â”‚      â”œâ”€â”€ threadExport.ts  # Markdown + image export       â”‚
â”‚      â”œâ”€â”€ threadChain.ts   # Handoff chains                â”‚
â”‚      â”œâ”€â”€ database.ts # SQLite for local metadata         â”‚
â”‚      â”œâ”€â”€ amp-api.ts  # Amp internal API client           â”‚
â”‚      â”œâ”€â”€ git.ts      # Git operations                    â”‚
â”‚      â””â”€â”€ git-activity.ts  # Commit/branch correlation    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                         â”‚
     ~/.local/share/amp/        ~/.amp-thread-manager/
     â””â”€â”€ threads/*.json         â”œâ”€â”€ threads.db (SQLite)
         (Amp thread data)      â””â”€â”€ artifacts/
```

## Data Storage

| Location                           | Purpose                                          |
| ---------------------------------- | ------------------------------------------------ |
| `~/.local/share/amp/threads/`      | Amp's thread JSON files (read by the server)     |
| `~/.amp-thread-manager/threads.db` | Local SQLite for status, blockers, linked issues |
| `~/.amp-thread-manager/artifacts/` | Saved images and notes per thread                |

## Keyboard Shortcuts

| Shortcut       | Action                    |
| -------------- | ------------------------- |
| `âŒ˜O`           | Command palette           |
| `âŒ˜N`           | New thread                |
| `âŒ˜R`           | Refresh threads           |
| `âŒ˜W`           | Close current thread      |
| `âŒ˜B`           | Toggle sidebar            |
| `âŒ˜H`           | Handoff current thread    |
| `âŒ˜T`           | Open shell terminal       |
| `j/k` or `â†“/â†‘` | Navigate thread list      |
| `Enter`        | Open focused thread       |
| `x`            | Toggle selection          |
| `Esc`          | Close modal / clear focus |

## Scripts

| Command           | Description                                     |
| ----------------- | ----------------------------------------------- |
| `pnpm dev`        | Start dev server (Vite frontend + Node backend) |
| `pnpm build`      | Build for production                            |
| `pnpm start`      | Build and serve production                      |
| `pnpm check`      | Lint + typecheck + build                        |
| `pnpm lint`       | ESLint                                          |
| `pnpm typecheck`  | TypeScript type check                           |
| `pnpm test`       | Run tests (Vitest)                              |
| `pnpm test:watch` | Run tests in watch mode                         |

## Configuration

| Environment Variable | Default       | Description                  |
| -------------------- | ------------- | ---------------------------- |
| `PORT`               | `3001`        | Backend server port          |
| `AMP_HOME`           | `$HOME`       | Base directory for Amp data  |
| `AMP_BIN`            | auto-detected | Path to the `amp` CLI binary |

## Security

This is a **local development tool**. The server binds to `localhost` only and is not accessible from other devices. See [SECURITY.md](SECURITY.md) for details.

## Troubleshooting

### Native module build errors (`better-sqlite3`, `node-pty`)

These packages require compilation. Make sure you have:

- **macOS**: Xcode Command Line Tools (`xcode-select --install`)
- **Linux**: `build-essential`, `python3`
- Node.js 25+ (check with `node -v`)

If builds fail, try: `pnpm rebuild`

### "Amp CLI not found"

Make sure `amp` is in your PATH, or set `AMP_BIN` to the full path of the binary.

### Port already in use

Set a different port: `PORT=3002 pnpm dev`

## Tech Stack

- **Frontend**: React 19, TypeScript, Vite
- **Backend**: Node.js with raw `http` module (no Express)
- **Database**: SQLite via better-sqlite3
- **WebSocket**: `ws` for real-time agent streaming
- **Terminal**: xterm.js + node-pty for shell sessions
- **Testing**: Vitest, Testing Library
- **Styling**: CSS custom properties (no UI framework)

## License

[Apache License 2.0](LICENSE)
